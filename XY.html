<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EurekaAI - منصة الذكاء الاصطناعي المتقدم</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://js.puter.com/v2/"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/5.1.1/marked.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#5D5CDE',
                        secondary: '#4F46E5',
                        accent: '#EC4899',
                        dark: '#181818'
                    },
                    fontFamily: {
                        'arabic': ['Cairo', 'Segoe UI', 'Tahoma', 'Geneva', 'Verdana', 'sans-serif']
                    },
                    animation: {
                        'fade-in-up': 'fadeInUp 0.6s ease-out',
                        'fade-in-left': 'fadeInLeft 0.6s ease-out',
                        'fade-in-right': 'fadeInRight 0.6s ease-out',
                        'float': 'float 3s ease-in-out infinite',
                        'pulse-slow': 'pulse 3s ease-in-out infinite',
                        'gradient': 'gradient 8s ease infinite',
                        'typing': 'typing 1s ease-in-out infinite',
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700;900&display=swap');
        
        body {
            font-family: 'Cairo', sans-serif;
        }
        
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes fadeInLeft {
            from { opacity: 0; transform: translateX(-30px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        @keyframes fadeInRight {
            from { opacity: 0; transform: translateX(30px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }
        
        @keyframes gradient {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        @keyframes typing {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        .gradient-bg {
            background: linear-gradient(-45deg, #5D5CDE, #4F46E5, #EC4899, #8B5CF6);
            background-size: 400% 400%;
            animation: gradient 8s ease infinite;
        }
        
        .glass-effect {
            backdrop-filter: blur(20px);
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .dark .glass-effect {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .glow {
            box-shadow: 0 0 20px rgba(93, 92, 222, 0.3);
        }
        
        .dark .glow {
            box-shadow: 0 0 30px rgba(93, 92, 222, 0.5);
        }
        
        .text-gradient {
            background: linear-gradient(135deg, #5D5CDE, #EC4899);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .chat-container {
            height: calc(100vh - 120px);
        }
        
        .message-bubble {
            max-width: 70%;
            word-wrap: break-word;
        }
        
        .typing-indicator {
            display: inline-block;
        }
        
        .typing-indicator span {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: #5D5CDE;
            margin: 0 2px;
            animation: typing 1.4s ease-in-out infinite;
        }
        
        .typing-indicator span:nth-child(2) {
            animation-delay: 0.2s;
        }
        
        .typing-indicator span:nth-child(3) {
            animation-delay: 0.4s;
        }
        
        .scrollbar-hide {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        
        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }
        
        .model-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        
        .model-card.selected {
            border-color: #5D5CDE;
            box-shadow: 0 0 0 3px rgba(93, 92, 222, 0.1);
        }
    </style>
</head>
<body class="bg-white dark:bg-dark transition-colors duration-300">
    <!-- Navigation -->
    <nav class="fixed top-0 w-full z-50 glass-effect">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center space-x-4 space-x-reverse">
                    <div class="text-2xl font-bold text-gradient cursor-pointer" onclick="showModelSelection()">
                        <i class="fas fa-brain mr-2"></i>
                        EurekaAI
                    </div>
                </div>
                
                <div class="flex items-center space-x-4 space-x-reverse">
                    <div id="currentModelName" class="hidden text-sm font-medium text-gray-600 dark:text-gray-300"></div>
                    <button id="newChatBtn" class="hidden bg-primary text-white px-4 py-2 rounded-lg hover:bg-secondary transition-all duration-300" onclick="newChat()">
                        <i class="fas fa-plus mr-2"></i>
                        محادثة جديدة
                    </button>
                    <button id="backBtn" class="hidden text-gray-600 dark:text-gray-300 hover:text-primary transition-colors" onclick="showModelSelection()">
                        <i class="fas fa-arrow-left text-xl"></i>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Model Selection Screen -->
    <div id="modelSelection" class="pt-16 min-h-screen bg-gray-50 dark:bg-gray-900">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div class="text-center mb-12 animate-fade-in-up">
                <h1 class="text-4xl md:text-5xl font-bold text-gray-900 dark:text-white mb-4">
                    اختر نموذج <span class="text-gradient">الذكاء الاصطناعي</span>
                </h1>
                <p class="text-xl text-gray-600 dark:text-gray-300 max-w-2xl mx-auto">
                    مجموعة متنوعة من نماذج الذكاء الاصطناعي المتقدمة لتلبية جميع احتياجاتك
                </p>
            </div>

            <!-- Search and Filter -->
            <div class="mb-8">
                <div class="flex flex-col sm:flex-row gap-4 justify-center items-center">
                    <div class="relative w-full sm:w-96">
                        <input type="text" id="searchInput" placeholder="ابحث عن نموذج..." 
                               class="w-full px-4 py-3 pr-12 text-base bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-primary focus:border-transparent">
                        <i class="fas fa-search absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                    </div>
                    <div class="flex gap-2">
                        <button class="filter-btn active px-4 py-3 bg-primary text-white rounded-xl" data-category="all">الكل</button>
                        <button class="filter-btn px-4 py-3 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-xl" data-category="chat">دردشة</button>
                        <button class="filter-btn px-4 py-3 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-xl" data-category="image">صور</button>
                        <button class="filter-btn px-4 py-3 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-xl" data-category="voice">صوت</button>
                    </div>
                </div>
            </div>

            <!-- AI Models Grid -->
            <div id="modelsGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                <!-- Chat Models -->
                <div class="model-card bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg cursor-pointer transition-all duration-300" 
                     data-category="chat" data-model="o3-mini" onclick="selectModel(this, 'OpenAI o3-mini', 'chat')">
                    <div class="w-16 h-16 bg-gradient-to-br from-blue-500 to-black-500 rounded-xl flex items-center justify-center mb-4 overflow-hidden">
                         <img src="img/open-ai-square.svg" alt="Claude Icon" class="w-20 h-20 object-contain">
                      </div>
                    <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-2">OpenAI o3-mini</h3>
                    <p class="text-gray-600 dark:text-gray-300 text-sm mb-3">أحدث نموذج من OpenAI للذكاء الاصطناعي المتقدم</p>
                    <div class="flex items-center justify-between">
                        <span class="text-xs bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 px-2 py-1 rounded-full">مجاني</span>
                        <span class="text-xs text-gray-500">دردشة</span>
                    </div>
                </div>

                <div class="model-card bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg cursor-pointer transition-all duration-300" 
                     data-category="chat" data-model="gpt-4o-mini" onclick="selectModel(this, 'GPT-4o Mini', 'chat')">
                    <div class="w-16 h-16 bg-gradient-to-br from-blue-500 to-purple-500 rounded-xl flex items-center justify-center mb-4 overflow-hidden">
                         <img src="img/openai-blue-logo.webp" alt="Claude Icon" class="w-20 h-20 object-contain">
                      </div>

                    <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-2">GPT-4o Mini</h3>
                    <p class="text-gray-600 dark:text-gray-300 text-sm mb-3">نسخة مطورة وسريعة من GPT-4</p>
                    <div class="flex items-center justify-between">
                        <span class="text-xs bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 px-2 py-1 rounded-full">مجاني</span>
                        <span class="text-xs text-gray-500">دردشة</span>
                    </div>
                </div>

                <div class="model-card bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg cursor-pointer transition-all duration-300" 
                     data-category="chat" data-model="grok-beta" onclick="selectModel(this, 'grok-beta', 'chat')">
                    <div class="w-16 h-16 bg-gradient-to-br from-blue-500 to-purple-500 rounded-xl flex items-center justify-center mb-4 overflow-hidden">
                         <img src="img/Vgg2hEPa_400x400.jpg" alt="Claude Icon" class="w-20 h-20 object-contain">
                      </div>
                    <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-2">Grok beta</h3>
                    <p class="text-gray-600 dark:text-gray-300 text-sm mb-3">نسخة مطورة وسريعة من Grok</p>
                    <div class="flex items-center justify-between">
                        <span class="text-xs bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 px-2 py-1 rounded-full">مجاني</span>
                        <span class="text-xs text-gray-500">دردشة</span>
                    </div>
                </div>

                <div class="model-card bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg cursor-pointer transition-all duration-300" 
                     data-category="chat" data-model="gemini-2.0-flash" onclick="selectModel(this, 'gemini-2.0-flash', 'chat')">
                    <div class="w-16 h-16 bg-gradient-to-br from-blue-500 to-purple-500 rounded-xl flex items-center justify-center mb-4 overflow-hidden">
                         <img src="img/generate-ai-abstract-vector-symbol-artificial-intelligence-colorful-stars-icon_34480-1539.jpg" alt="Claude Icon" class="w-20 h-20 object-contain">
                      </div>
                    <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-2">Gemini 2.0 Flash</h3>
                    <p class="text-gray-600 dark:text-gray-300 text-sm mb-3">نسخة مطورة وسريعة من Gemini</p>
                    <div class="flex items-center justify-between">
                        <span class="text-xs bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 px-2 py-1 rounded-full">مجاني</span>
                        <span class="text-xs text-gray-500">دردشة</span>
                    </div>
                </div>


                <div class="model-card bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg cursor-pointer transition-all duration-300" 
                     data-category="chat" data-model="gemini-1.5-flash" onclick="selectModel(this, 'gemini-1.5-flash', 'chat')">
                    <div class="w-16 h-16 bg-gradient-to-br from-blue-0 to-purple-0 rounded-xl flex items-center justify-center mb-4 overflow-hidden">
                         <img src="img/gemini-google-icon-symbol-logo-free-png.webp" alt="Claude Icon" class="w-20 h-20 object-contain">
                      </div>
                    <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-2">Gemini 1.5 Flash</h3>
                    <p class="text-gray-600 dark:text-gray-300 text-sm mb-3">نسخة مطورة وسريعة من Gemini</p>
                    <div class="flex items-center justify-between">
                        <span class="text-xs bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 px-2 py-1 rounded-full">مجاني</span>
                        <span class="text-xs text-gray-500">دردشة</span>
                    </div>
                </div>


                <div class="model-card bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg cursor-pointer transition-all duration-300" data-category="chat" data-model="claude-sonnet-4" onclick="selectModel(this, 'claude-sonnet-4', 'chat')">

    <!-- استبدلنا الأيقونة بالصورة -->
                    <div class="w-16 h-16 bg-gradient-to-br from-blue-0 to-purple-0 rounded-xl flex items-center justify-center mb-4 overflow-hidden">
                         <img src="img/peueeehosysccnmwsszx-removebg-preview.png" alt="Claude Icon" class="w-15 h-15 object-contain">
                      </div>

                 <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-2">Claude Sonnet 4</h3>
                 <p class="text-gray-600 dark:text-gray-300 text-sm mb-3">نسخة مطورة من Claude</p>
                 <div class="flex items-center justify-between">
                          <span class="text-xs bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 px-2 py-1 rounded-full">مجاني</span>
                          <span class="text-xs text-gray-500">دردشة</span>
                     </div>
                </div>


                <div class="model-card bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg cursor-pointer transition-all duration-300" 
                     data-category="chat" data-model="deepseek-chat" onclick="selectModel(this, 'DeepSeek Chat', 'chat')">
                    <div class="w-16 h-16 bg-gradient-to-br from-blue-0 to-purple-0 rounded-xl flex items-center justify-center mb-4 overflow-hidden">
                         <img src="img/deepseek-color.png" alt="DeepSeek Icon" class="w-15 h-15 object-contain">
                      </div>
                    <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-2">DeepSeek Chat-V3</h3>
                    <p class="text-gray-600 dark:text-gray-300 text-sm mb-3">DeepSeek Chat : نموذج متقدم للدردشة الذكية</p>
                    <div class="flex items-center justify-between">
                        <span class="text-xs bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 px-2 py-1 rounded-full">مجاني</span>
                        <span class="text-xs text-gray-500">دردشة</span>
                    </div>
                </div>

                <div class="model-card bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg cursor-pointer transition-all duration-300" 
                     data-category="chat" data-model="gpt-4o" onclick="selectModel(this, 'GPT-4o', 'chat')">
                    <div class="w-16 h-16 bg-gradient-to-br from-blue-0 to-purple-0 rounded-xl flex items-center justify-center mb-4 overflow-hidden">
                         <img src="img/GPT-4.jpg" alt="DeepSeek Icon" class="w-15 h-15 object-contain">
                      </div>
                    <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-2">GPT-4o</h3>
                    <p class="text-gray-600 dark:text-gray-300 text-sm mb-3">النموذج الأقوى من OpenAI</p>
                    <div class="flex items-center justify-between">
                        <span class="text-xs bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 px-2 py-1 rounded-full">مجاني</span>
                        <span class="text-xs text-gray-500">دردشة</span>
                    </div>
                </div>

                <div class="model-card bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg cursor-pointer transition-all duration-300" 
                     data-category="chat" data-model="claude-3.5-sonnet" onclick="selectModel(this, 'Claude 3.5 Sonnet', 'chat')">
                    <div class="w-16 h-16 bg-gradient-to-br from-blue-0 to-purple-0 rounded-xl flex items-center justify-center mb-4 overflow-hidden">
                         <img src="img/images (1).png" alt="DeepSeek Icon" class="w-15 h-15 object-contain">
                      </div>
                    <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-2">Claude 3.5 Sonnet</h3>
                    <p class="text-gray-600 dark:text-gray-300 text-sm mb-3">نموذج متقدم للمحادثات الذكية والتحليل المعمق</p>
                    <div class="flex items-center justify-between">
                        <span class="text-xs bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 px-2 py-1 rounded-full">مجاني</span>
                        <span class="text-xs text-gray-500">دردشة</span>
                    </div>
                </div>

                <div class="model-card bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg cursor-pointer transition-all duration-300" 
                     data-category="chat" data-model="gemini-1.5-pro" onclick="selectModel(this, 'Gemini 1.5 Pro', 'chat')">
                    <div class="w-16 h-16 bg-gradient-to-br from-blue-0 to-purple-0 rounded-xl flex items-center justify-center mb-4 overflow-hidden">
                         <img src="img/unnamed.webp" alt="DeepSeek Icon" class="w-15 h-15 object-contain">
                      </div>
                    <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-2">Gemini 1.5 Pro</h3>
                    <p class="text-gray-600 dark:text-gray-300 text-sm mb-3">نموذج Google المتطور للمحادثات والتحليل</p>
                    <div class="flex items-center justify-between">
                        <span class="text-xs bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 px-2 py-1 rounded-full">مجاني</span>
                        <span class="text-xs text-gray-500">دردشة</span>
                    </div>
                </div>

                <!-- Image Models -->
                <div class="model-card bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg cursor-pointer transition-all duration-300" 
                     data-category="image" data-model="dall-e-3" onclick="selectModel(this, 'DALL-E 3', 'image')">
                    <div class="w-16 h-16 bg-gradient-to-br from-pink-500 to-red-500 rounded-xl flex items-center justify-center mb-4">
                        <i class="fas fa-image text-2xl text-white"></i>
                    </div>
                    <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-2">DALL-E 3</h3>
                    <p class="text-gray-600 dark:text-gray-300 text-sm mb-3">توليد صور عالية الجودة من النصوص</p>
                    <div class="flex items-center justify-between">
                        <span class="text-xs bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 px-2 py-1 rounded-full">مجاني</span>
                        <span class="text-xs text-gray-500">صور</span>
                    </div>
                </div>

                <div class="model-card bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg cursor-pointer transition-all duration-300" 
                     data-category="image" data-model="flux-1.1-pro" onclick="selectModel(this, 'FLUX 1.1 Pro', 'image')">
                    <div class="w-16 h-16 bg-gradient-to-br from-cyan-500 to-blue-500 rounded-xl flex items-center justify-center mb-4">
                        <i class="fas fa-palette text-2xl text-white"></i>
                    </div>
                    <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-2">FLUX 1.1 Pro</h3>
                    <p class="text-gray-600 dark:text-gray-300 text-sm mb-3">نموذج متقدم لتوليد الصور الاحترافية</p>
                    <div class="flex items-center justify-between">
                        <span class="text-xs bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 px-2 py-1 rounded-full">مجاني</span>
                        <span class="text-xs text-gray-500">صور</span>
                    </div>
                </div>

                <!-- Voice Models -->
                <div class="model-card bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg cursor-pointer transition-all duration-300" 
                     data-category="voice" data-model="elevenlabs" onclick="selectModel(this, 'ElevenLabs TTS', 'voice')">
                    <div class="w-16 h-16 bg-gradient-to-br from-teal-500 to-green-500 rounded-xl flex items-center justify-center mb-4">
                        <i class="fas fa-microphone text-2xl text-white"></i>
                    </div>
                    <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-2">ElevenLabs TTS</h3>
                    <p class="text-gray-600 dark:text-gray-300 text-sm mb-3">تحويل النص إلى كلام بجودة عالية</p>
                    <div class="flex items-center justify-between">
                        <span class="text-xs bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 px-2 py-1 rounded-full">مجاني</span>
                        <span class="text-xs text-gray-500">صوت</span>
                    </div>
                </div>

                <!-- Additional specialized models -->
                <div class="model-card bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg cursor-pointer transition-all duration-300" 
                     data-category="chat" data-model="llama-3.1-405b" onclick="selectModel(this, 'Llama 3.1 405B', 'chat')">
                    <div class="w-16 h-16 bg-gradient-to-br from-gray-700 to-gray-900 rounded-xl flex items-center justify-center mb-4">
                        <i class="fas fa-code text-2xl text-white"></i>
                    </div>
                    <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-2">Llama 3.1 405B</h3>
                    <p class="text-gray-600 dark:text-gray-300 text-sm mb-3">نموذج Meta القوي مفتوح المصدر</p>
                    <div class="flex items-center justify-between">
                        <span class="text-xs bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 px-2 py-1 rounded-full">مجاني</span>
                        <span class="text-xs text-gray-500">دردشة</span>
                    </div>
                </div>

                <div class="model-card bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg cursor-pointer transition-all duration-300" 
                     data-category="image" data-model="gpt-4o-vision" onclick="selectModel(this, 'GPT-4o Vision', 'vision')">
                    <div class="w-16 h-16 bg-gradient-to-br from-emerald-500 to-teal-500 rounded-xl flex items-center justify-center mb-4">
                        <i class="fas fa-eye text-2xl text-white"></i>
                    </div>
                    <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-2">GPT-4o Vision</h3>
                    <p class="text-gray-600 dark:text-gray-300 text-sm mb-3">تحليل وفهم محتوى الصور والمستندات</p>
                    <div class="flex items-center justify-between">
                        <span class="text-xs bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 px-2 py-1 rounded-full">مجاني</span>
                        <span class="text-xs text-gray-500">رؤية</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Chat Interface -->
    <div id="chatInterface" class="hidden pt-16 h-screen flex flex-col">
        <!-- Chat Header -->
        <div class="bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-4 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3 space-x-reverse">
                    <div id="modelIcon" class="w-10 h-10 bg-primary rounded-full flex items-center justify-center">
                        <i class="fas fa-robot text-white"></i>
                    </div>
                    <div>
                        <h2 id="chatModelName" class="text-lg font-semibold text-gray-900 dark:text-white"></h2>
                        <p id="modelDescription" class="text-sm text-gray-500 dark:text-gray-400"></p>
                    </div>
                </div>
                <div class="flex items-center space-x-2 space-x-reverse">
                    <button class="p-2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 transition-colors" onclick="clearChat()">
                        <i class="fas fa-trash"></i>
                    </button>
                    <button class="p-2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 transition-colors" onclick="exportChat()">
                        <i class="fas fa-download"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Chat Messages -->
        <div id="chatMessages" class="flex-1 overflow-y-auto scrollbar-hide bg-gray-50 dark:bg-gray-900 px-4 py-6">
            <div class="max-w-4xl mx-auto">
                <div class="text-center py-8">
                    <div class="w-20 h-20 bg-gradient-to-br from-primary to-accent rounded-full flex items-center justify-center mx-auto mb-4 animate-pulse-slow">
                        <i class="fas fa-robot text-2xl text-white"></i>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-2">مرحباً! كيف يمكنني مساعدتك؟</h3>
                    <p class="text-gray-600 dark:text-gray-400">ابدأ محادثتك مع الذكاء الاصطناعي</p>
                </div>
            </div>
        </div>

        <!-- Chat Input -->
        <div class="bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 p-4">
            <div class="max-w-4xl mx-auto">
                <div class="flex items-end space-x-3 space-x-reverse">
                    <div class="flex-1">
                        <div class="relative">
                            <textarea id="messageInput" 
                            placeholder="اكتب رسالتك هنا..." 
                               class="w-full px-4 py-3 text-base bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-2xl resize-none focus:ring-2 focus:ring-primary focus:border-transparent max-h-32 text-black dark:text-white"
                                  rows="1"></textarea>
                            <button id="attachBtn" class="absolute left-3 bottom-3 p-1 text-gray-500 hover:text-primary transition-colors"  color="white">
                                <i class="fas fa-paperclip"></i>
                            </button>
                        </div>
                        <input type="file" id="fileInput" accept="image/*,audio/*,.pdf,.txt,.doc,.docx" class="hidden">
                    </div>
                    <button id="sendBtn" 
                            class="bg-primary text-white p-3 rounded-2xl hover:bg-secondary transition-all duration-300 transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed"
                            onclick="sendMessage()">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
                <div id="attachedFile" class="hidden mt-2 p-2 bg-gray-100 dark:bg-gray-700 rounded-lg">
                    <div class="flex items-center justify-between">
                        <span id="fileName" class="text-sm text-gray-600 dark:text-gray-300"></span>
                        <button onclick="removeAttachment()" class="text-red-500 hover:text-red-700">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
            </div>        </div>
    </div>

    <script>
        // Global variables
        let currentModel = null;
        let currentModelType = null;
        let currentModelName = '';
        let chatHistory = [];
        let attachedFile = null;

        // Dark mode detection
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });

        // Initialize application
        async function initApp() {
            try {
                // Setup event listeners
                setupEventListeners();
                
                // Setup search and filter functionality
                setupSearchAndFilter();
                
                console.log('EurekaAI initialized successfully');
            } catch (error) {
                console.error('Failed to initialize:', error);
                showError('فشل في تهيئة التطبيق. يرجى إعادة تحميل الصفحة.');
            }
        }

        // Setup event listeners
        function setupEventListeners() {
            // Message input auto-resize
            const messageInput = document.getElementById('messageInput');
            messageInput.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = Math.min(this.scrollHeight, 120) + 'px';
            });

            // Send message on Enter (Shift+Enter for new line)
            messageInput.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });

            // File attachment
            document.getElementById('attachBtn').addEventListener('click', () => {
                document.getElementById('fileInput').click();
            });

            document.getElementById('fileInput').addEventListener('change', handleFileAttachment);
        }

        // Setup search and filter functionality
        function setupSearchAndFilter() {
            const searchInput = document.getElementById('searchInput');
            const filterBtns = document.querySelectorAll('.filter-btn');
            const modelCards = document.querySelectorAll('.model-card');

            // Search functionality
            searchInput.addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase();
                filterModels(searchTerm, getCurrentFilter());
            });

            // Filter functionality
            filterBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    // Update active filter button
                    filterBtns.forEach(b => {
                        b.classList.remove('active', 'bg-primary', 'text-white');
                        b.classList.add('bg-gray-200', 'dark:bg-gray-700', 'text-gray-700', 'dark:text-gray-300');
                    });
                    
                    this.classList.add('active', 'bg-primary', 'text-white');
                    this.classList.remove('bg-gray-200', 'dark:bg-gray-700', 'text-gray-700', 'dark:text-gray-300');

                    // Apply filter
                    const category = this.dataset.category;
                    const searchTerm = searchInput.value.toLowerCase();
                    filterModels(searchTerm, category);
                });
            });
        }

        // Get current filter
        function getCurrentFilter() {
            const activeBtn = document.querySelector('.filter-btn.active');
            return activeBtn ? activeBtn.dataset.category : 'all';
        }

        // Filter models
        function filterModels(searchTerm, category) {
            const modelCards = document.querySelectorAll('.model-card');
            
            modelCards.forEach(card => {
                const modelName = card.querySelector('h3').textContent.toLowerCase();
                const modelDescription = card.querySelector('p').textContent.toLowerCase();
                const modelCategory = card.dataset.category;
                
                const matchesSearch = modelName.includes(searchTerm) || modelDescription.includes(searchTerm);
                const matchesCategory = category === 'all' || modelCategory === category;
                
                if (matchesSearch && matchesCategory) {
                    card.style.display = 'block';
                    card.classList.add('animate-fade-in-up');
                } else {
                    card.style.display = 'none';
                }
            });
        }

        // Select model
        function selectModel(element, modelName, modelType) {
            // Remove previous selection
            document.querySelectorAll('.model-card').forEach(card => {
                card.classList.remove('selected');
            });

            // Add selection to current card
            element.classList.add('selected');

            // Set current model - استخدام النموذج المحدد من data-model
            currentModel = element.dataset.model;
            currentModelType = modelType;
            currentModelName = modelName;

            console.log('Selected model:', currentModel); // للتأكد من النموذج المختار

            // Update UI
            setTimeout(() => {
                showChatInterface();
            }, 300);
        }

        // Show chat interface
        function showChatInterface() {
            document.getElementById('modelSelection').classList.add('hidden');
            document.getElementById('chatInterface').classList.remove('hidden');
            
            // Update header
            document.getElementById('currentModelName').textContent = currentModelName;
            document.getElementById('currentModelName').classList.remove('hidden');
            document.getElementById('newChatBtn').classList.remove('hidden');
            document.getElementById('backBtn').classList.remove('hidden');
            
            // Update chat header
            document.getElementById('chatModelName').textContent = currentModelName;
            document.getElementById('modelDescription').textContent = getModelDescription(currentModelType);
            
            // Clear previous chat
            clearChat();
            
            // Focus on input
            document.getElementById('messageInput').focus();
        }

        // Show model selection
        function showModelSelection() {
            document.getElementById('chatInterface').classList.add('hidden');
            document.getElementById('modelSelection').classList.remove('hidden');
            
            // Update header
            document.getElementById('currentModelName').classList.add('hidden');
            document.getElementById('newChatBtn').classList.add('hidden');
            document.getElementById('backBtn').classList.add('hidden');
            
            // Clear model selection
            currentModel = null;
            currentModelType = null;
            currentModelName = '';
        }

        // Get model description
        function getModelDescription(modelType) {
            const descriptions = {
                'chat': 'متاح للمحادثة والأسئلة العامة',
                'image': 'متاح لتوليد وتحليل الصور',
                'voice': 'متاح لمعالجة الصوت والكلام',
                'vision': 'متاح لتحليل وفهم الصور'
            };
            return descriptions[modelType] || 'متاح للاستخدام';
        }

        // Send message
        async function sendMessage() {
            const messageInput = document.getElementById('messageInput');
            const userMessage = messageInput.value.trim();
            
            if (!userMessage && !attachedFile) return;
            
            // Disable send button
            const sendBtn = document.getElementById('sendBtn');
            sendBtn.disabled = true;
            
            try {
                // Add user message to chat
                addMessage(userMessage, 'user');
                
                // Clear input
                messageInput.value = '';
                messageInput.style.height = 'auto';
                
                // Clear attachment
                removeAttachment();
                
                // Send to AI using the exact same logic as your working example
                const chat_resp = await puter.ai.chat(userMessage, { 
                    model: currentModel, 
                    stream: true 
                });
                
                let botMsg = '';
                addMessage('...', 'bot'); // مؤقت حتى يجي الرد
                
                for await (const part of chat_resp) {
                    if (part?.text) {
                        botMsg += part.text;
                        // Update the last bot message
                        const chatMessages = document.getElementById('chatMessages');
                        const lastBotMessage = chatMessages.querySelector('.bot-message:last-child .message-content');
                        if (lastBotMessage) {
                            lastBotMessage.innerHTML = formatMessage(botMsg);
                            chatMessages.scrollTop = chatMessages.scrollHeight;
                        }
                    }
                }
                
            } catch (error) {
                console.error('Error sending message:', error);
                addMessage('عذراً، حدث خطأ في الاتصال بالذكاء الاصطناعي. يرجى المحاولة مرة أخرى.', 'bot');
            } finally {
                sendBtn.disabled = false;
            }
        }

        // Add message to chat (simplified like your working example)
        function addMessage(text, sender) {
            const chatMessages = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `flex mb-4 ${sender === 'user' ? 'justify-end' : 'justify-start'} ${sender === 'bot' ? 'bot-message' : ''}`;
            
            const isUser = sender === 'user';
            const bubbleClass = isUser 
                ? 'bg-primary text-white' 
                : 'bg-white dark:bg-gray-800 text-gray-900 dark:text-white border border-gray-200 dark:border-gray-700';
            
            messageDiv.innerHTML = `
                <div class="message-bubble ${bubbleClass} px-4 py-3 rounded-2xl shadow-sm max-w-[70%]">
                    ${!isUser ? '<div class="flex items-center mb-2"><div class="w-6 h-6 bg-primary rounded-full flex items-center justify-center mr-2"><i class="fas fa-robot text-xs text-white"></i></div><span class="text-sm font-medium">' + currentModelName + '</span></div>' : ''}
                    <div class="message-content">${formatMessage(text)}</div>
                    <div class="text-xs ${isUser ? 'text-blue-100' : 'text-gray-500 dark:text-gray-400'} mt-1">
                        ${new Date().toLocaleTimeString('ar-SA', { hour: '2-digit', minute: '2-digit' })}
                    </div>
                </div>
            `;
            
            chatMessages.appendChild(messageDiv);
            
            // Add to history
            chatHistory.push({
                sender,
                message: text,
                timestamp: new Date()
            });
            
            // Scroll to bottom
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            // Add animation
            messageDiv.classList.add('animate-fade-in-up');
        }

        // Format message (support markdown)
        function formatMessage(message) {
            if (typeof marked !== 'undefined') {
                return marked.parse(message);
            }
            return message.replace(/\n/g, '<br>');
        }

        // Handle file attachment
        function handleFileAttachment(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            // Check file size (max 10MB)
            if (file.size > 10 * 1024 * 1024) {
                showError('حجم الملف كبير جداً. الحد الأقصى 10 ميجابايت.');
                return;
            }
            
            attachedFile = file;
            
            // Show attached file
            document.getElementById('attachedFile').classList.remove('hidden');
            document.getElementById('fileName').textContent = file.name;
        }

        // Remove attachment
        function removeAttachment() {
            attachedFile = null;
            document.getElementById('attachedFile').classList.add('hidden');
            document.getElementById('fileInput').value = '';
        }

        // Clear chat
        function clearChat() {
            document.getElementById('chatMessages').innerHTML = `
                <div class="max-w-4xl mx-auto">
                    <div class="text-center py-8">
                        <div class="w-20 h-20 bg-gradient-to-br from-primary to-accent rounded-full flex items-center justify-center mx-auto mb-4 animate-pulse-slow">
                            <i class="fas fa-robot text-2xl text-white"></i>
                        </div>
                        <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-2">مرحباً! كيف يمكنني مساعدتك؟</h3>
                        <p class="text-gray-600 dark:text-gray-400">ابدأ محادثتك مع ${currentModelName}</p>
                    </div>
                </div>
            `;
            chatHistory = [];
        }

        // New chat
        function newChat() {
            clearChat();
            removeAttachment();
            document.getElementById('messageInput').focus();
        }

        // Export chat
        function exportChat() {
            if (chatHistory.length === 0) {
                showError('لا توجد محادثة لتصديرها.');
                return;
            }
            
            const chatText = chatHistory.map(msg => {
                const time = msg.timestamp.toLocaleString('ar-SA');
                const sender = msg.sender === 'user' ? 'أنت' : currentModelName;
                return `[${time}] ${sender}: ${msg.message}`;
            }).join('\n\n');
            
            const blob = new Blob([chatText], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `EurekaAI_Chat_${new Date().toISOString().split('T')[0]}.txt`;
            a.click();
            URL.revokeObjectURL(url);
        }

        // Show error
        function showError(message) {
            // Create custom error modal
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-white bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg max-w-sm w-full mx-4">
                    <div class="flex items-center mb-4">
                        <i class="fas fa-exclamation-triangle text-red-500 text-2xl mr-3"></i>
                        <h3 class="text-lg font-semibold text-gray-900 dark:text-white">تنبيه</h3>
                    </div>
                    <p class="text-gray-700 dark:text-gray-300 mb-4">${message}</p>
                    <div class="flex justify-end">
                        <button class="px-4 py-2 bg-primary text-white hover:bg-secondary rounded-lg transition-colors" onclick="this.closest('.fixed').remove()">
                            حسناً
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            
            // Auto remove after 5 seconds
            setTimeout(() => {
                if (modal.parentNode) {
                    modal.remove();
                }
            }, 5000);
        }

        // Initialize app when page loads
        window.addEventListener('load', initApp);
    </script>
</body>
</html>
